@model IEnumerable<Sinergia.Models.LogModificaViewModel>
@{
    var index = 1;
    string nomeTabella = ViewBag.NomeTabella as string ?? "";
}

@foreach (var item in Model)
{
    var dataFinale = item.Data ?? DateTime.Now;
    string descrizione = item.ModificheTestuali ?? "";
    string nomeUtente = string.IsNullOrWhiteSpace(item.NomeUtente) ? "–" : item.NomeUtente;
    string versione = item.NumeroVersione.ToString();
    string id = item.ID.ToString();

    string testoRicerca = $"{descrizione} {nomeUtente} {versione}";

    <tr data-data="@dataFinale.ToString("yyyy-MM-dd")"
        data-ricerca="@((descrizione + " " + versione + " " + nomeUtente).ToLower())">
        <td>@(index++)</td>
        <td>@dataFinale.ToString("dd/MM/yyyy HH:mm")</td>
        <td>@nomeUtente</td>
        <td>@versione</td>
        <td>@item.Riassunto</td>   @* 👈 Usa il campo calcolato per dettaglio *@
        <td class="text-center">
            <button class="btn btn-sm btn-outline-primary" onclick="apriDettaglio('@nomeTabella', '@id')">
                <i class="fas fa-eye"></i>
            </button>
        </td>
    </tr>
}
